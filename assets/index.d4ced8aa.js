import{G as g}from"./vendor.34f1e898.js";const _=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const a of h.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerpolicy&&(h.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?h.credentials="include":i.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function n(i){if(i.ep)return;i.ep=!0;const h=e(i);fetch(i.href,h)}};_();var d=Math.PI*2,x=function(s){this.$element,this.direction,this.speed,this.x_sign=1,this.y_sign=1,this.lasttic,this.lastdistance,this.delta_x,this.delta_y,this.delta_t,this.pp=[],this.hits,this.maxHits,this.alive,this.radius,this.maxRadius,this.growthRate,this.onDeath,this.startTime,this.dataCollector=null,this.lastMissTime,this.totalMisses,this.last_x,this.last_y,this.explosion_sound,this.setPosition=function(t,e,n,i){this.$element.offset({left:t,top:e}),this.last_x=t,this.last_y=e},this.setRadius=function(t){t=Math.min(t,this.maxRadius),this.radius=t,this.$element.css("width",t*2),this.$element.css("height",t*2),this.$element.css("border-radius",t)},this.tic=function(){if(!!this.alive&&!(Date.now()<this.startAfter)){this.$element.css("visibility","visible"),this.delta_t=Date.now()-this.lasttic,this.delta_t>500&&(this.delta_t=500);var t=this.$element.offset(),e=t.left,n=t.top,i=this.delta_t*this.speed;this.lastdistance=i;var h=e+Math.cos(this.direction)*i*this.x_sign,a=n+Math.sin(this.direction)*i*this.y_sign;this.delta_x=h-e,this.delta_y=a-n,this.delta_x>0&&h>$(window).width()-this.$element.width()?this.x_sign=this.x_sign*-1:this.delta_x<0&&h<0&&(this.x_sign=this.x_sign*-1),this.delta_y>0&&a>$(window).height()-this.$element.height()?this.y_sign=this.y_sign*-1:this.delta_y<0&&a<0&&(this.y_sign=this.y_sign*-1),this.direction=this.direction%d,this.setPosition(h,a,"tic",{x:e,y:n,dist:i,delta_t:this.delta_t}),this.setRadius(this.radius+this.radius*this.growthRate*this.delta_t),this.lasttic=Date.now()}},this.clickHandler=function(t){if(!!this.alive&&(this.hits++,this.hits>=this.maxHits)){if(this.alive=0,this.dataCollector&&this.dataCollector.event({event:"targetHit",latency:Date.now()-this.startTime,radius:this.radius,speed:this.speed,misses:this.totalMisses}),this.explosion_sound)try{this.explosion_sound.currentTime=0,this.explosion_sound.play()}catch(e){alert(JSON.stringify(e))}this.shrapnelManager&&this.shrapnelManager.create(Math.floor(this.radius/10+Math.random()*6-3),{x:this.$element.offset().left,y:this.$element.offset().top,radius:this.radius,direction:this.direction,x_sign:this.x_sign,y_sign:this.y_sign}),this.onDeath&&this.onDeath(),this.$element.length&&(this.$element.off(),$("body").off(),this.$element.remove(),this.alive=0)}},this.missHandler=function(t){var e=t.pageX,n=t.pageY;this.$element.offset();var i=Math.floor(Math.sqrt(Math.pow(e-(this.last_x+this.radius),2)+Math.pow(n-(this.last_y+this.radius),2)));return this.totalMisses++,this.dataCollector&&this.dataCollector.event({event:"targetMiss",dist:i,mousePos:[e,n],lastPos:[Math.floor(this.last_x),Math.floor(this.last_y)],latency:Date.now()-this.startTime,radius:this.radius,speed:this.speed,miss:this.totalMisses}),this.lastMissTime=Date.now(),!1},this.startIn=t=>{this.startAfter=Date.now()+t,console.log(`this.startAfter ${this.startAfter} alive: ${this.alive} t: ${t}`)},this.init=function(t){console.log("target.init()"),this.startAfter=0,this.maxRadius=200,this.initialRadius=100,this.growthRate=1e-4,this.alive=1,this.hits=0,this.maxHits=1,this.direction=Math.random()*d,this.speed=.1,this.lasttic=Date.now(),this.startTime=this.lasttic,this.totalMisses=0,$("#explosion_sound").length!=0&&(this.explosion_sound=document.getElementById("explosion_sound")),(!this.$element||this.$element.length==0)&&(this.$element=$("<div id=target></div>"),this.$element.css("visibility","hidden"),this.setRadius(this.initialRadius),$("body").append(this.$element));const n=(()=>($(window).width(),$(window).height(),{x:Math.floor(Math.random()*($(window).width()-this.radius*2)),y:Math.floor(Math.random()*($(window).height()-this.radius*2))}))();this.setPosition(n.x,n.y,"init"),this.$element.bind("touchstart",function(i){this.clickHandler(i),i.stopPropagation()}.bind(this)),this.$element.bind("mousedown",function(i){this.clickHandler(i),i.stopPropagation()}.bind(this)),$("body").bind("touchstart",function(i){this.missHandler(i),i.stopPropagation()}.bind(this)),$("body").bind("mousedown",function(i){this.missHandler(i),i.stopPropagation()}.bind(this)),t&&t.dataCollector&&(this.dataCollector=t.dataCollector,this.dataCollector.event({event:"newTarget",radius:this.radius,speed:this.speed}))},this.init(s)},y=function(s){this.$element,this.direction,this.speed,this.speedDecayRate,this.deathSpeed,this.x_sign=1,this.y_sign=1,this.lasttic,this.lastdistance,this.delta_x,this.delta_y,this.delta_t,this.pp=[],this.hits,this.maxHits,this.alive,this.size,this.minSize,this.maxSize,this.growthRate,this.onDeath,this.maxAge,this.startTime,this.rotation,this.rotationRate,this.red=255,this.alpha=1,this.setPosition=function(t,e,n,i){this.pp.length>10||(this.pp.push({t:this.delta_t,x:t,y:e}),this.$element.offset({left:t,top:e}))},this.getAge=function(){return this.startTime?Date.now()-this.startTime:0},this.die=function(){this.alive=0,this.$element.length&&this.$element.remove()},this.tic=function(){if(this.alive!=0){if(this.getAge()>=this.maxAge||this.speed<=this.deathSpeed){this.die();return}this.$element.length==0&&this.init(),this.delta_t=Date.now()-this.lasttic,this.delta_t>500&&(this.delta_t=500);var t=this.$element.offset(),e=t.left,n=t.top,i=this.delta_t*this.speed;this.lastdistance=i;var h=e+Math.cos(this.direction)*i*this.x_sign,a=n+Math.sin(this.direction)*i*this.y_sign;this.delta_x=h-e,this.delta_y=a-n,this.delta_x>0&&h>$(window).width()-this.$element.width()?this.x_sign=this.x_sign*-1:this.delta_x<0&&h<0&&(this.x_sign=this.x_sign*-1),this.delta_y>0&&a>$(window).height()-this.$element.height()?this.y_sign=this.y_sign*-1:this.delta_y<0&&a<0&&(this.y_sign=this.y_sign*-1),this.direction=this.direction%PI2,this.setPosition(h,a,"tic",{x:e,y:n,dist:i,delta_t:this.delta_t}),this.$element.offset({left:h,top:a}),this.speed=this.speed-this.speed*this.speedDecayRate*this.delta_t,this.rotation+=this.rotationRate*this.delta_t,this.rotationRate-=this.rotationRate*this.speedDecayRate*this.delta_t,this.$element.css("transform","rotate("+this.rotation*10+"deg)"),this.lasttic=Date.now()}},this.init=function(t){this.startTime=Date.now(),this.maxAge=32e3-Math.random()*300,this.alive=1,this.hits=0,this.maxHits=1,t.hasOwnProperty("direction")?(this.direction=t.direction+(Math.random()*1-.5),this.y_sign=t.y_sign,this.x_sign=t.x_sign):this.direction=Math.random()*PI2,this.speed=.07+Math.pow(4*Math.random(),-2)/2,this.speed=Math.min(this.speed,1),this.speedDecayRate=.002,this.deathSpeed=.05,this.rotation=0,this.rotationRate=Math.random()/3,this.minSize=5,this.maxSize=40,this.size=Math.random()*(this.maxSize-this.minSize)+this.minSize,this.lasttic=Date.now(),(!this.$element||this.$element.length==0)&&(this.$element=$("<div id=shrapnel"+Math.floor(Math.random()*101010)+"></div>"),this.$element.addClass("shrapnel"),this.$element.css("border-left",this.size*.86+"px solid transparent"),this.$element.css("border-right",this.size*.86+"px solid transparent"),this.$element.css("border-top",this.size+"px solid #f00"),$("body").append(this.$element)),this.setPosition(t.x+Math.random()*t.radius*2-t.radius,t.y+Math.random()*t.radius*2-t.radius,"init")},this.init(s)},v=function(){this.shrapnel=[],this.maxDuration=10,this.lastIndex=0,this.tics=0,this.efficiency=0,this.duration=0,this.timePerIteration=[],this.dataCollector=null,this.debug=0,this.create=function(s,t){for(var e=0;e<s;e++)this.shrapnel.push(new y(t))},this.tic=function(){if(this.shrapnel.length!=0){var s=Date.now();for(this.tics=0,debug==1&&(this.timePerIteration=[]);Date.now()-s<this.maxDuration&&this.shrapnel.length>0&&(this.tics++,this.lastIndex=Math.max(-1,Math.min(this.lastIndex,this.shrapnel.length)-1),this.lastIndex==-1&&(this.lastIndex=this.shrapnel.length-1),!(this.shrapnel[this.lastIndex]._tic&&this.shrapnel[this.lastIndex]._tic==s));)this.shrapnel[this.lastIndex].tic(),this.shrapnel[this.lastIndex]._tic=s,this.shrapnel[this.lastIndex].alive||this.shrapnel.splice(this.lastIndex,1),debug==1&&(this.timePerIteration.length==0?this.timePerIteration.push(Date.now()-s):this.timePerIteration.push(Date.now()-s));debug==1&&this.dataCollector&&this.dataCollector.event({debug,event:"ShrapnelTic",timePerIter:this.timePerIteration}),this.tics>0&&(this.duration=Date.now()-s),this.tics>0&&(this.efficiency=this.tics/this.duration)}}};new g;var w=function(){this.debug=0,this.debug&&(this.$element=$("<div id=datacollector></div>"),this.$element.css("position","fixed"),this.$element.css("left","100px"),this.$element.css("width","80%"),this.$element.css("height","100px"),this.$element.css("bottom","100px"),this.$element.css("overflow-y","scroll"),this.$element.css("background","rgba(200,200,200,.5)"),this.$element.css("padding","2px 2px 2px 2px"),this.$element.css("border-style","solid"),this.$element.css("border-width","1px"),this.$element.css("font-size",".75em"),$("body").append(this.$element)),this.data=[],this.startTime=Date.now(),this.event=function(s){s||(s={undefined:!0}),s.hasOwnProperty("event")||(s.event="undefined"),s.hasOwnProperty("time")||(s.time=Date.now()),this.data.push(s),this.debug&&this.$element.prepend(Date.now()-this.startTime+"	"+JSON.stringify(s)+"<br>")},this.click=function(s){s.hasOwnProperty("event")||(s.event="click"),this.event(s),console.log(s)}},l,r,o,c,f,m=0;function M(s,t,e){return Math.floor(Math.sqrt(Math.pow(t-(s.last_x+s.radius),2)+Math.pow(e-(s.last_y+s.radius),2)))}const u=s=>(o={},o=new x({dataCollector:l}),o.shrapnelManager=r,s||(s=0),o.startIn(s),m==0&&(o.explosion_sound.load(),m=1),o);function b(){l=new w,r=new v,r.dataCollector=l,u(),$(document).mousemove(function(s){c=s.pageX,f=s.pageY,M(o,c,f)}).bind(this),p()}function p(){requestAnimationFrame(p),o.tic(),r.tic(),o.alive||u(1500)}window.onload=b;
